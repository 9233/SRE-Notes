ç½‘é¡µè¿æ¥åœ°å€: https://www.cnblogs.com/web1992/p/4714465.html

gitweb æ­å»ºæ•™ç¨‹
1. å‰è¨€

ã€€ã€€git æ˜¯ä¸€ä¸ªç‰ˆæœ¬æ§åˆ¶å·¥å…·ï¼Œç±»ä¼¼svn.

ã€€ã€€æœ¬æ–‡å†…å®¹ä¸»è¦æ¶‰åŠgitä»“åº“é€šè¿‡æµè§ˆå™¨è®¿é—®(ç”¨webçš„æ–¹å¼å»æŸ¥çœ‹gitæäº¤å†å²è®°å½•,tag,branchç­‰ä¿¡æ¯)ï¼Œå³gitweb.

ã€€ã€€æ•ˆæœå›¾ï¼š

ã€€ã€€ã€€ã€€ã€€ã€€

ã€€ã€€ã€€ã€€ã€€ã€€

ã€€ã€€åœ¨è¿™é‡Œè¯´ä¸‹ gitweb çš„è¿è¡Œæµç¨‹ï¼ˆç»„æˆéƒ¨åˆ†ï¼‰ï¼Œæ–¹ä¾¿æ•´ç†æ€è·¯ä»¥åŠåç»­æŸ¥æ‰¾é—®é¢˜æ‰€åœ¨ï¼Œç»„æˆå›¾ï¼š

ã€€ã€€ã€€ã€€ã€€ã€€

ã€€ã€€æƒ³è¦æ­å»ºgitweb å¿…é¡»å‡†å¤‡ä¸‰ä¸ªä¸»è¦ç¯å¢ƒæ”¯æŒ:apache, cgi è¿è¡Œç¯å¢ƒï¼Œgit

ã€€ã€€apache  æä¾›æµè§ˆå™¨çš„æ–¹å¼ï¼Œå°±å¦‚Svn å¯ä»¥é€šè¿‡æµè§ˆå™¨è®¿é—®ä¸€æ ·ï¼Œéƒ½æ˜¯æœ‰apache çš„æ”¯æŒ

ã€€ã€€cgi  è¿™é‡Œç”¨æ¥è§£ægitweb.cgi è„šæœ¬ï¼ˆå°±å¦‚html é€šè¿‡æµè§ˆå™¨è§£æï¼Œå˜æˆç½‘é¡µä¸€æ ·ï¼‰

ã€€ã€€git  ç¯å¢ƒæ”¯æŒï¼Œå¦‚åŒè¿è¡Œjavaç¨‹åºï¼Œä¸€å®šè¦æœ‰jdk ç¯å¢ƒä¸€æ ·

ã€€ã€€

 

ã€€ã€€2. git ä»“åº“åˆå§‹åŒ–

ã€€ã€€ã€€ã€€ã€€ã€€è¿™é‡Œä»“åº“çš„ä½œç”¨å°±å¦‚æ•°æ®åº“ï¼Œæ¥å­˜å‚¨ä½ çš„ä»£ç 
å¤åˆ¶ä»£ç 

sudo mkdir demo2
cd demo2/

sudo git init

Initialized empty Git repository in /data/git/demo1/demo2/.git/ls -la
total 0
drwxr-xr-x   3 root  wheel  102  8  9 22:15 .
drwxr-xr-x   6 root  wheel  204  8  9 22:14 ..
drwxr-xr-x  10 root  wheel  340  8  9 22:15 .git

// readme.md  æ–°å»ºæ–‡ä»¶
// æŠŠæ–°å»ºçš„æ–‡ä»¶æ·»åŠ åˆ°git ç´¢å¼•ä¸­ (. ä¸èƒ½å°‘ï¼Œè¡¨ç¤ºå½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶)
sudo git add .

git status   // æŸ¥çœ‹çŠ¶æ€

On branch master

Initial commit

Changes to be committed:
  (use "git rm --cached <file>..." to unstage)

    new file:   readme.md
// æäº¤
sudo git commit -am "init"   

[master (root-commit) 832bb9e] init
 1 file changed, 2 insertions(+)
 create mode 100644 readme.md

å¤åˆ¶ä»£ç 

ã€€ã€€ã€€3. é…ç½®Apache çš„cgiæ¨¡å— 

ã€€ã€€ã€€ã€€cgi æŒ‰ç…§å¯ä»¥å‚ç…§ (http://www.cnblogs.com/web1992/p/4525286.html)

ã€€ã€€ã€€ã€€ æŸ¥è¯¢ä½ çš„apache æ˜¯å¦å®‰è£…äº†cgi  æ¨¡å—ï¼Œå‘½ä»¤å¦‚ä¸‹
å¤åˆ¶ä»£ç 

 sudo apachectl -M |grep cgi
 // å‡ºç°è¿™ä¸ª cgi-module è¡¨ç¤ºå·²ç»å®‰è£…äº†cgi 
 proxy_fcgi_module (shared)
 proxy_scgi_module (shared)
 cgi_module (shared)

ã€€

å¤åˆ¶ä»£ç 

ã€€ã€€åœ¨ Apache httpd.conf é…ç½®æ–‡ä»¶ä¸­æ·»åŠ 

ã€€ã€€ã€€ã€€Include /etc/apache2/vhost/*.confã€€

           #è¿™é‡Œçš„æ„æ€æˆ‘çš„ gitweb.conf æ–‡ä»¶æ”¾åœ¨ /etc/apache2/vhost/ æ–‡ä»¶å¤¹ä¸‹é¢ï¼Œ

ã€€ã€€ã€€ã€€è¿™é‡Œé€šè¿‡Apache çš„è™šæ‹Ÿä¸»æœºï¼ˆvhostï¼‰æ¥è®¿é—®gitwebï¼Œé…ç½®å¦‚ä¸‹(éƒ½æœ‰è‹±æ–‡æ³¨é‡Š)ï¼š
å¤åˆ¶ä»£ç 

localhost:vhost web$ cat gitweb.conf 
        
#Alias /git /usr/local/git/share/gitweb
#Alias /git /usr/local/git-share/share/gitweb
Alias /git /usr/local/share/gitweb/gitweb/ 

<Directory /usr/local/share/gitweb/gitweb/>
  #Options +ExecCGI
  #AddHandler cgi-script .cgi
  #DirectoryIndex gitweb.cgi
  # Let anyone see our repositories (for now)
  Order allow,deny
  AllowOverride None
 # Rquiree all granted
  Options Indexes FollowSymLinks ExecCGI
  Allow from all
  Satisfy Any
  # Enable CGI in this directory
  Options +ExecCGI
  
  # Run .cgi files using mod_cgi
  AddHandler cgi-script .cgi
  
  # Use gitweb.cgi for directory listings. This takes care of
  # requests to /git and /git/
  # é…ç½®index 

  DirectoryIndex gitweb.cgi
  
  # This tells gitweb.cgi where to find its config file
  # By default it looks in /etc/gitweb.conf, so if you place
  # your config file somewhere else you should specify this.
  #SetEnv  GITWEB_CONFIG  /etc/gitweb.conf
  
  #SetEnv  GITWEB_CONFIG    /usr/local/git/share/gitweb/gitweb-css.conf
  # è¿™é‡Œé…ç½®gitä»“åº“ä½ç½®ï¼Œcss æ ·å¼, git å®‰è£…è·¯å¾„ 
  # gitweb-css.conf  ååˆ†é‡è¦
  SetEnv  GITWEB_CONFIG    /usr/local/share/gitweb/gitweb/gitweb-css.conf
  
  # Enable mod_rewrite
  RewriteEngine on
  
  # Rewrite /git/repo.git URIs to be /git/gitweb.cgi/repo.git
  # This assumes your repository names end with '.git'. I don't
  # know if that is always a safe assumption.
  RewriteRule ^([^.]+\.git.*)$ /git/gitweb.cgi/$0 [L,PT]
</Directory>

å¤åˆ¶ä»£ç 

ã€€ã€€ åœ¨è¿™é‡Œæ³¨æ„ï¼Œæˆ‘çš„gitweb ç›¸å…³çš„cgiè„šæœ¬ & é™æ€çš„èµ„æºï¼ˆcss,imgç­‰ï¼‰éƒ½åœ¨

ã€€ã€€ã€€/usr/local/share/gitweb/gitweb/

ã€€ã€€ã€€ã€€æ–‡ä»¶ä¸‹é¢ï¼Œå¦‚ä¸‹ï¼šã€€
å¤åˆ¶ä»£ç 

localhost:vhost web$ ls -la /usr/local/share/gitweb/gitweb/
total 504
drwxr-xr-x  5 web  admin     170  8  9 01:40 .
drwxr-xr-x  3 web  admin     102  8  9 01:11 ..
-rw-r--r--  1 web  admin    1303  8  9 01:40 gitweb-css.conf
-rwxr-xr-x  1 web  admin  251379  8  9 01:15 gitweb.cgi
drwxr-xr-x  6 web  admin     204  8  9 01:11 static
localhost:vhost web$ 

å¤åˆ¶ä»£ç 

ã€€ã€€4.  gitweb cgiè„šæœ¬é…ç½® & é™æ€èµ„æºé…ç½®

ã€€ã€€ã€€  gitweb-css.conf  å†…å®¹ï¼šã€€ 
å¤åˆ¶ä»£ç 

localhost:vhost web$ cat /usr/local/share/gitweb/gitweb/gitweb-css.conf 

#####################################################################################
# This is the directory where your git repositories live
# git çš„ä»“åº“ä½ç½®ï¼Œååˆ†é‡è¦
$projectroot = '/data/git/';

# This is the title of the site
$site_name = "ç”¨ç”¨çš„ç¬¨ç¬¨ç¬¨ç¬¨çš„ç”¨ç”¨ gitweb site";

# This is used to generate the URI for each repo
$my_uri = "/git";

# Text and URI for the home link
$home_link_str = "My Projects";
# å¥½åƒä¸æ”¯æŒä¸­æ–‡ %>_<%
#$home_link_str = "ç”¨ç”¨çš„ç¬¨ç¬¨ç¬¨ç¬¨çš„ç”¨ç”¨ Projects";
$home_link = "/git";

# These tell gitweb the URIs for the images and css it needs.
# Depending on the version of GitWeb you have there may be
# different locations. Newer versions include a /static/ path
# element and a javascript library.

###### OLDER GITWEB ######################
#@stylesheets = ("/git/gitweb.css");
#$logo = "/git/git-logo.png";
#$favicon = "/git/git-favicon.png";
#$javascript = "/git/gitweb.js";
#  è¿™é‡Œé…ç½®css  æ ·å¼çš„è·¯å¾„ï¼Œå¦‚æœé…ç½®ä¸æ­£ç¡®ï¼Œé¡µé¢å°±ä¼šå¾ˆä¸‘çš„~~
##### NEWER GITWEB #######################
@stylesheets = ("/git/static/gitweb.css");
$logo = "/git/static/git-logo.png";
$favicon = "/git/static/git-favicon.png";
$javascript = "/git/static/gitweb.js";


# This just makes the description field wider so you can read 
# it better
$projects_list_description_width = 50;

# This makes repo links use pretty URLs like /git/repo.git
$feature{'pathinfo'}{'default'} = [1];

å¤åˆ¶ä»£ç 

ã€€ã€€ç¼–è¾‘ gitweb.cgi  åœ¨æ–‡ä»¶çš„ çº¦77 è¡Œå¤„ï¼Œå¯ä»¥æ‰¾åˆ°  our $GIT   è¿™é‡Œ è®¾ç½®git çš„å®‰è£…è·¯å¾„ï¼ˆå¦‚æœå®‰è£…gitè·¯å¾„ä¸é…ç½®ä¸æ­£ç¡®ï¼Œä¼šæŠ¥500å†…éƒ¨é”™è¯¯ï¼‰ 
å¤åˆ¶ä»£ç 

  73 # core git executable to use
  74 # this can just be "git" if your webserver has a sensible PATH
  75 #our $GIT = "/usr/local/git/bin/git";
  76 #our $GIT = "/usr/local/bin/git";
  77 our $GIT = "/usr/bin/git";
  78 
  79 # absolute fs-path which will be prepended to the project path
  80 #our $projectroot = "/pub/scm";
  81 our $projectroot = "/pub/git";

å¤åˆ¶ä»£ç 

ã€€ã€€ç¬¬ä¸€è¡Œå¯ä»¥çœ‹åˆ° #!/usr/bin/perl  å­—æ ·ï¼Œä½¿ç”¨perl å†™çš„é¡µé¢ï¼ˆå¥½ç¾¡æ…• ğŸ˜¢ï¼‰
å¤åˆ¶ä»£ç 

   1 #!/usr/bin/perl
   2 
   3 # gitweb - simple web interface to track changes in git repositories
   4 #
   5 # (C) 2005-2006, Kay Sievers <kay.sievers@vrfy.org>
   6 # (C) 2005, Christian Gierke
   7 #
   8 # This program is licensed under the GPLv2

å¤åˆ¶ä»£ç 

 

ã€€ã€€å¦‚ä½•æŸ¥è¯¢è‡ªå·±çš„git å®‰è£…è·¯å¾„

localhost:vhost web$ which git
/usr/bin/git

 ã€€åœ¨è¿™é‡Œé…ç½®ä¹‹åé‡å¯Apache ï¼Œåœ¨æµè§ˆå™¨è®¿é—®ï¼šhttp://127.0.0.1/git/

ã€€ã€€

ã€€ giwebé™„ä»¶ï¼šã€€http://pan.baidu.com/s/1c0nqjxYã€€

ã€€ end ~
